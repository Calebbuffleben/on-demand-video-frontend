{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///Users/calebbuffleben/Desktop/projetos/stream/frontend/src/pages/_document.tsx"],"sourcesContent":["import { Html, Head, Main, NextScript } from \"next/document\";\n\nexport default function Document() {\n  return (\n    <Html lang=\"en\">\n      <Head />\n      <body className=\"antialiased\">\n        <Main />\n        <NextScript />\n      </body>\n    </Html>\n  );\n}\n"],"names":[],"mappings":";;;;AAAA;;;AAEe,SAAS;IACtB,qBACE,qKAAC,yHAAA,CAAA,OAAI;QAAC,MAAK;;0BACT,qKAAC,yHAAA,CAAA,OAAI;;;;;0BACL,qKAAC;gBAAK,WAAU;;kCACd,qKAAC,yHAAA,CAAA,OAAI;;;;;kCACL,qKAAC,yHAAA,CAAA,aAAU;;;;;;;;;;;;;;;;;AAInB"}},
    {"offset": {"line": 97, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 135, "column": 0}, "map": {"version":3,"sources":["file:///Users/calebbuffleben/Desktop/projetos/stream/frontend/src/contexts/AuthContext.tsx"],"sourcesContent":["'use client';\n\nimport React, { createContext, useContext, useState, useEffect } from 'react';\nimport { useRouter } from 'next/router';\nimport { useClerk, useUser } from '@clerk/nextjs';\n\ninterface AuthContextType {\n  isAuthenticated: boolean;\n  user: any;\n  loading: boolean;\n  logout: () => void;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport const AuthProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n  const [loading, setLoading] = useState(true);\n  const { signOut } = useClerk();\n  const { user, isLoaded: isUserLoaded } = useUser();\n  const router = useRouter();\n\n  useEffect(() => {\n    if (isUserLoaded) {\n      setLoading(false);\n    }\n  }, [isUserLoaded]);\n\n  const logout = async () => {\n    await signOut();\n    router.push('/sign-in');\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{\n        isAuthenticated: !!user,\n        user,\n        loading,\n        logout,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = (): AuthContextType => {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\nexport const useAuthService = () => {\n  const { session, user } = useClerk();\n\n  const getToken = async (): Promise<string | null> => {\n    try {\n      if (!session) return null;\n      return await session.getToken();\n    } catch (error) {\n      console.error('Error getting token:', error);\n      return null;\n    }\n  };\n\n  const isAuthenticated = (): boolean => {\n    return !!user;\n  };\n\n  const getUserDetails = () => {\n    if (!user) return null;\n    \n    return {\n      id: user.id,\n      fullName: `${user.firstName} ${user.lastName}`,\n      email: user.primaryEmailAddress?.emailAddress,\n      imageUrl: user.imageUrl\n    };\n  };\n\n  return {\n    getToken,\n    isAuthenticated,\n    getUserDetails\n  };\n};\n"],"names":[],"mappings":";;;;;;AAEA;AACA;AACA;AAJA;;;;;AAaA,MAAM,4BAAc,CAAA,GAAA,mGAAA,CAAA,gBAAa,AAAD,EAA+B;AAExD,MAAM,eAAwD,CAAC,EAAE,QAAQ,EAAE;IAChF,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,mGAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,EAAE,OAAO,EAAE,GAAG,CAAA,GAAA,qJAAA,CAAA,WAAQ,AAAD;IAC3B,MAAM,EAAE,IAAI,EAAE,UAAU,YAAY,EAAE,GAAG,CAAA,GAAA,qJAAA,CAAA,UAAO,AAAD;IAC/C,MAAM,SAAS,CAAA,GAAA,uHAAA,CAAA,YAAS,AAAD;IAEvB,CAAA,GAAA,mGAAA,CAAA,YAAS,AAAD,EAAE;QACR,IAAI,cAAc;YAChB,WAAW;QACb;IACF,GAAG;QAAC;KAAa;IAEjB,MAAM,SAAS;QACb,MAAM;QACN,OAAO,IAAI,CAAC;IACd;IAEA,qBACE,qKAAC,YAAY,QAAQ;QACnB,OAAO;YACL,iBAAiB,CAAC,CAAC;YACnB;YACA;YACA;QACF;kBAEC;;;;;;AAGP;AAEO,MAAM,UAAU;IACrB,MAAM,UAAU,CAAA,GAAA,mGAAA,CAAA,aAAU,AAAD,EAAE;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;AACO,MAAM,iBAAiB;IAC5B,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,CAAA,GAAA,qJAAA,CAAA,WAAQ,AAAD;IAEjC,MAAM,WAAW;QACf,IAAI;YACF,IAAI,CAAC,SAAS,OAAO;YACrB,OAAO,MAAM,QAAQ,QAAQ;QAC/B,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,wBAAwB;YACtC,OAAO;QACT;IACF;IAEA,MAAM,kBAAkB;QACtB,OAAO,CAAC,CAAC;IACX;IAEA,MAAM,iBAAiB;QACrB,IAAI,CAAC,MAAM,OAAO;QAElB,OAAO;YACL,IAAI,KAAK,EAAE;YACX,UAAU,GAAG,KAAK,SAAS,CAAC,CAAC,EAAE,KAAK,QAAQ,EAAE;YAC9C,OAAO,KAAK,mBAAmB,EAAE;YACjC,UAAU,KAAK,QAAQ;QACzB;IACF;IAEA,OAAO;QACL;QACA;QACA;IACF;AACF"}},
    {"offset": {"line": 216, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 222, "column": 0}, "map": {"version":3,"sources":["file:///Users/calebbuffleben/Desktop/projetos/stream/frontend/src/hooks/useClerkToken.ts"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { useClerk, useUser, useOrganization } from '@clerk/nextjs';\n\n/**\n * This hook ensures the Clerk token is stored in localStorage\n * so the API service can use it for authenticated requests\n */\nexport function useClerkToken() {\n  const { session } = useClerk();\n  const { user, isLoaded: userLoaded } = useUser();\n  const { organization, isLoaded: orgLoaded } = useOrganization();\n  const [lastOrgId, setLastOrgId] = useState<string | null>(null);\n  \n  // This effect handles token storage when organization changes\n  useEffect(() => {\n    // Wait until both user and organization data are loaded\n    if (!userLoaded || !orgLoaded) return;\n    \n    // Skip if organization hasn't changed\n    if (organization?.id === lastOrgId) return;\n    \n    // Update last org id\n    setLastOrgId(organization?.id || null);\n    \n    const storeToken = async () => {\n      if (!session) {\n        console.warn('No active session found');\n        localStorage.removeItem('token');\n        return;\n      }\n      \n      try {\n        console.log('Getting token from Clerk session...');\n        console.log('Current organization:', organization?.id, organization?.name);\n        \n        // Get organization-aware token - ensure our JWT template includes org claims\n        const tokenOptions = organization?.id \n          ? { \n              template: 'token_videos_on_demand_2',  // Use a template with organization claims\n              // You can also provide session data if needed\n              session: {\n                resources: [\"organization\"],\n                organizationId: organization.id,\n              }\n            } \n          : {};\n        \n        const token = await session.getToken(tokenOptions);\n        \n        if (token) {\n          // Store token with organization info\n          localStorage.setItem('token', token);\n          \n          // Store current organization ID separately for reference\n          if (organization?.id) {\n            localStorage.setItem('currentOrganizationId', organization.id);\n          } else {\n            localStorage.removeItem('currentOrganizationId');\n          }\n          \n          console.log('Token stored successfully with organization context');\n          \n          // Log user membership info for debugging\n          if (user) {\n            console.log('User organizations:', user.organizationMemberships?.length || 0);\n            user.organizationMemberships?.forEach(membership => {\n              const isActive = membership.organization.id === organization?.id;\n              console.log(`- Org: ${membership.organization.name} (${membership.organization.id}), Role: ${membership.role}${isActive ? ' [ACTIVE]' : ''}`);\n            });\n          }\n        } else {\n          console.warn('Empty token received from Clerk');\n        }\n      } catch (error) {\n        console.error('Failed to get or store Clerk token:', error);\n      }\n    };\n    \n    // Store token initially\n    storeToken();\n  }, [session, user, userLoaded, organization, orgLoaded, lastOrgId]);\n  \n  // This effect sets up token refresh on an interval\n  useEffect(() => {\n    // Setup polling interval to refresh token\n    const intervalId = setInterval(() => {\n      // Only refresh if we have a session and user is loaded\n      if (session && userLoaded) {\n        // This will trigger the above effect if organization has changed\n        setLastOrgId(organization?.id || null);\n      }\n    }, 1000 * 60 * 5); // Check every 5 minutes\n    \n    return () => {\n      clearInterval(intervalId);\n    };\n  }, [session, userLoaded, organization]);\n}\n\nexport default useClerkToken; "],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;AASO,SAAS;IACd,MAAM,EAAE,OAAO,EAAE,GAAG,CAAA,GAAA,qJAAA,CAAA,WAAQ,AAAD;IAC3B,MAAM,EAAE,IAAI,EAAE,UAAU,UAAU,EAAE,GAAG,CAAA,GAAA,qJAAA,CAAA,UAAO,AAAD;IAC7C,MAAM,EAAE,YAAY,EAAE,UAAU,SAAS,EAAE,GAAG,CAAA,GAAA,qJAAA,CAAA,kBAAe,AAAD;IAC5D,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,mGAAA,CAAA,WAAQ,AAAD,EAAiB;IAE1D,8DAA8D;IAC9D,CAAA,GAAA,mGAAA,CAAA,YAAS,AAAD,EAAE;QACR,wDAAwD;QACxD,IAAI,CAAC,cAAc,CAAC,WAAW;QAE/B,sCAAsC;QACtC,IAAI,cAAc,OAAO,WAAW;QAEpC,qBAAqB;QACrB,aAAa,cAAc,MAAM;QAEjC,MAAM,aAAa;YACjB,IAAI,CAAC,SAAS;gBACZ,QAAQ,IAAI,CAAC;gBACb,aAAa,UAAU,CAAC;gBACxB;YACF;YAEA,IAAI;gBACF,QAAQ,GAAG,CAAC;gBACZ,QAAQ,GAAG,CAAC,yBAAyB,cAAc,IAAI,cAAc;gBAErE,6EAA6E;gBAC7E,MAAM,eAAe,cAAc,KAC/B;oBACE,UAAU;oBACV,8CAA8C;oBAC9C,SAAS;wBACP,WAAW;4BAAC;yBAAe;wBAC3B,gBAAgB,aAAa,EAAE;oBACjC;gBACF,IACA,CAAC;gBAEL,MAAM,QAAQ,MAAM,QAAQ,QAAQ,CAAC;gBAErC,IAAI,OAAO;oBACT,qCAAqC;oBACrC,aAAa,OAAO,CAAC,SAAS;oBAE9B,yDAAyD;oBACzD,IAAI,cAAc,IAAI;wBACpB,aAAa,OAAO,CAAC,yBAAyB,aAAa,EAAE;oBAC/D,OAAO;wBACL,aAAa,UAAU,CAAC;oBAC1B;oBAEA,QAAQ,GAAG,CAAC;oBAEZ,yCAAyC;oBACzC,IAAI,MAAM;wBACR,QAAQ,GAAG,CAAC,uBAAuB,KAAK,uBAAuB,EAAE,UAAU;wBAC3E,KAAK,uBAAuB,EAAE,QAAQ,CAAA;4BACpC,MAAM,WAAW,WAAW,YAAY,CAAC,EAAE,KAAK,cAAc;4BAC9D,QAAQ,GAAG,CAAC,CAAC,OAAO,EAAE,WAAW,YAAY,CAAC,IAAI,CAAC,EAAE,EAAE,WAAW,YAAY,CAAC,EAAE,CAAC,SAAS,EAAE,WAAW,IAAI,GAAG,WAAW,cAAc,IAAI;wBAC9I;oBACF;gBACF,OAAO;oBACL,QAAQ,IAAI,CAAC;gBACf;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,uCAAuC;YACvD;QACF;QAEA,wBAAwB;QACxB;IACF,GAAG;QAAC;QAAS;QAAM;QAAY;QAAc;QAAW;KAAU;IAElE,mDAAmD;IACnD,CAAA,GAAA,mGAAA,CAAA,YAAS,AAAD,EAAE;QACR,0CAA0C;QAC1C,MAAM,aAAa,YAAY;YAC7B,uDAAuD;YACvD,IAAI,WAAW,YAAY;gBACzB,iEAAiE;gBACjE,aAAa,cAAc,MAAM;YACnC;QACF,GAAG,OAAO,KAAK,IAAI,wBAAwB;QAE3C,OAAO;YACL,cAAc;QAChB;IACF,GAAG;QAAC;QAAS;QAAY;KAAa;AACxC;uCAEe"}},
    {"offset": {"line": 320, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 326, "column": 0}, "map": {"version":3,"sources":["file:///Users/calebbuffleben/Desktop/projetos/stream/frontend/src/components/TokenProvider.tsx"],"sourcesContent":["'use client';\n\nimport { ReactNode } from 'react';\nimport useClerkToken from '../hooks/useClerkToken';\n\ninterface TokenProviderProps {\n  children: ReactNode;\n}\n\nexport function TokenProvider({ children }: TokenProviderProps) {\n  // This hook handles storing the Clerk token in localStorage\n  useClerkToken();\n  \n  // Just render children - the hook does the work\n  return <>{children}</>;\n}\n\nexport default TokenProvider; "],"names":[],"mappings":";;;;;AAGA;AAHA;;;AASO,SAAS,cAAc,EAAE,QAAQ,EAAsB;IAC5D,4DAA4D;IAC5D,CAAA,GAAA,sHAAA,CAAA,UAAa,AAAD;IAEZ,gDAAgD;IAChD,qBAAO;kBAAG;;AACZ;uCAEe"}},
    {"offset": {"line": 344, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 382, "column": 0}, "map": {"version":3,"sources":["file:///Users/calebbuffleben/Desktop/projetos/stream/frontend/src/pages/_app.tsx"],"sourcesContent":["import \"@/styles/globals.css\";\nimport { ClerkProvider } from \"@clerk/nextjs\";\nimport type { AppProps } from \"next/app\";\nimport { AuthProvider } from \"../contexts/AuthContext\";\nimport TokenProvider from \"../components/TokenProvider\";\n\nexport default function App({ Component, pageProps }: AppProps) {\n  return (\n    <ClerkProvider {...pageProps}>\n      <TokenProvider>\n        <AuthProvider>\n          <Component {...pageProps} />\n        </AuthProvider>\n      </TokenProvider>\n    </ClerkProvider>\n  );\n}\n"],"names":[],"mappings":";;;;AAGA;AACA;AAHA;;;;;;AAKe,SAAS,IAAI,EAAE,SAAS,EAAE,SAAS,EAAY;IAC5D,qBACE,qKAAC,kKAAA,CAAA,gBAAa;QAAE,GAAG,SAAS;kBAC1B,cAAA,qKAAC,4HAAA,CAAA,UAAa;sBACZ,cAAA,qKAAC,wHAAA,CAAA,eAAY;0BACX,cAAA,qKAAC;oBAAW,GAAG,SAAS;;;;;;;;;;;;;;;;;;;;;AAKlC"}},
    {"offset": {"line": 422, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 427, "column": 0}, "map": {"version":3,"sources":["turbopack://[next]/internal/font/google/geist_240504b1.module.css [ssr] (css module)"],"sourcesContent":["__turbopack_export_value__({\n  \"className\": \"geist_240504b1-module__Yz_Fka__className\",\n  \"variable\": \"geist_240504b1-module__Yz_Fka__variable\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA","ignoreList":[0]}},
    {"offset": {"line": 431, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 437, "column": 0}, "map": {"version":3,"sources":["turbopack://[next]/internal/font/google/geist_240504b1.js"],"sourcesContent":["import cssModule from \"@vercel/turbopack-next/internal/font/google/cssmodule.module.css?{%22path%22:%22index.tsx%22,%22import%22:%22Geist%22,%22arguments%22:[{%22variable%22:%22--font-geist-sans%22,%22subsets%22:[%22latin%22]}],%22variableName%22:%22geistSans%22}\";\nconst fontData = {\n    className: cssModule.className,\n    style: {\n        fontFamily: \"'Geist', 'Geist Fallback'\",\n        fontStyle: \"normal\",\n\n    },\n};\n\nif (cssModule.variable != null) {\n    fontData.variable = cssModule.variable;\n}\n\nexport default fontData;\n"],"names":[],"mappings":";;;AAAA;;AACA,MAAM,WAAW;IACb,WAAW,8IAAA,CAAA,UAAS,CAAC,SAAS;IAC9B,OAAO;QACH,YAAY;QACZ,WAAW;IAEf;AACJ;AAEA,IAAI,8IAAA,CAAA,UAAS,CAAC,QAAQ,IAAI,MAAM;IAC5B,SAAS,QAAQ,GAAG,8IAAA,CAAA,UAAS,CAAC,QAAQ;AAC1C;uCAEe","ignoreList":[0]}},
    {"offset": {"line": 453, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 458, "column": 0}, "map": {"version":3,"sources":["turbopack://[next]/internal/font/google/geist_mono_32c496e5.module.css [ssr] (css module)"],"sourcesContent":["__turbopack_export_value__({\n  \"className\": \"geist_mono_32c496e5-module__ruWyfa__className\",\n  \"variable\": \"geist_mono_32c496e5-module__ruWyfa__variable\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA","ignoreList":[0]}},
    {"offset": {"line": 462, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 468, "column": 0}, "map": {"version":3,"sources":["turbopack://[next]/internal/font/google/geist_mono_32c496e5.js"],"sourcesContent":["import cssModule from \"@vercel/turbopack-next/internal/font/google/cssmodule.module.css?{%22path%22:%22index.tsx%22,%22import%22:%22Geist_Mono%22,%22arguments%22:[{%22variable%22:%22--font-geist-mono%22,%22subsets%22:[%22latin%22]}],%22variableName%22:%22geistMono%22}\";\nconst fontData = {\n    className: cssModule.className,\n    style: {\n        fontFamily: \"'Geist Mono', 'Geist Mono Fallback'\",\n        fontStyle: \"normal\",\n\n    },\n};\n\nif (cssModule.variable != null) {\n    fontData.variable = cssModule.variable;\n}\n\nexport default fontData;\n"],"names":[],"mappings":";;;AAAA;;AACA,MAAM,WAAW;IACb,WAAW,mJAAA,CAAA,UAAS,CAAC,SAAS;IAC9B,OAAO;QACH,YAAY;QACZ,WAAW;IAEf;AACJ;AAEA,IAAI,mJAAA,CAAA,UAAS,CAAC,QAAQ,IAAI,MAAM;IAC5B,SAAS,QAAQ,GAAG,mJAAA,CAAA,UAAS,CAAC,QAAQ;AAC1C;uCAEe","ignoreList":[0]}},
    {"offset": {"line": 484, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 500, "column": 0}, "map": {"version":3,"sources":["file:///Users/calebbuffleben/Desktop/projetos/stream/frontend/src/api-connection/service.ts"],"sourcesContent":["import axios from \"axios\";\n\nconst api = axios.create({\n    baseURL: process.env.BACKEND_URL || 'http://localhost:4000', // Updated to match backend port\n    headers: {\n        'Content-Type': 'application/json'\n    },\n    withCredentials: true\n});\n\n// Add request interceptor to include Clerk token from localStorage\napi.interceptors.request.use(\n    async (config) => {\n        if (typeof window === 'undefined') {\n            // We're on the server, so don't attempt to use localStorage\n            console.log('API request on server side - skipping auth token');\n            return config;\n        }\n        \n        // Get token from local storage\n        const token = localStorage.getItem('token');\n        const clerkOrgId = localStorage.getItem('currentOrganizationId');\n        const dbOrgId = localStorage.getItem('dbOrganizationId');\n        \n        // Log request details for debugging\n        console.log(`API ${config.method?.toUpperCase()} request to: ${config.url}`);\n        \n        if (token) {\n            config.headers['Authorization'] = `Bearer ${token}`;\n            \n            // Add organization context headers if available\n            if (clerkOrgId) {\n                // Always use Clerk ID for auth context\n                config.headers['X-Organization-Id'] = clerkOrgId;\n                console.log('Including Clerk organization ID:', clerkOrgId);\n            }\n            \n            // For endpoints that need database ID format\n            if (dbOrgId) {\n                config.headers['X-DB-Organization-Id'] = dbOrgId;\n                console.log('Including database organization ID:', dbOrgId);\n            }\n            \n            // For subscriptions endpoints, prioritize using database ID in URL\n            if (config.url && config.url.includes('/api/subscriptions/')) {\n                // If URL ends with 'current' or ID is already embedded, don't modify\n                if (!config.url.endsWith('/current') && \n                    !config.url.match(/\\/api\\/subscriptions\\/[a-zA-Z0-9_-]+$/)) {\n                    \n                    // Use database ID if available, otherwise use Clerk ID\n                    const orgIdForUrl = dbOrgId || clerkOrgId;\n                    if (orgIdForUrl) {\n                        config.url = `/api/subscriptions/${orgIdForUrl}`;\n                        console.log('Using organization ID in URL:', orgIdForUrl);\n                    }\n                }\n            }\n            \n            // Log token for debugging (truncated for security)\n            if (token.length > 20) {\n                console.log('Using token:', token.substring(0, 15) + '...');\n            }\n        } else {\n            console.warn('No authentication token found');\n        }\n        \n        return config;\n    },\n    (error) => {\n        return Promise.reject(error);\n    }\n);\n\n// Add response interceptor for error handling\napi.interceptors.response.use(\n    (response) => {\n        console.log(`API response from ${response.config.url}: Status ${response.status}`);\n        \n        // Only attempt to use localStorage on the client\n        if (typeof window !== 'undefined') {\n            // Check for organization ID in response and save it\n            if (response.data?.organization?.id) {\n                // If the ID format suggests a database ID (UUID), save it\n                if (/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(response.data.organization.id)) {\n                    console.log('Saving database organization ID from response:', response.data.organization.id);\n                    localStorage.setItem('dbOrganizationId', response.data.organization.id);\n                }\n                \n                // If there's a clerkId field, save that too\n                if (response.data.organization.clerkId) {\n                    console.log('Saving Clerk organization ID from response:', response.data.organization.clerkId);\n                    localStorage.setItem('currentOrganizationId', response.data.organization.clerkId);\n                }\n            }\n        }\n        \n        return response;\n    },\n    (error) => {\n        console.error('API error:', error?.response?.data || error.message);\n        \n        // Only attempt to use localStorage and event dispatching on the client\n        if (typeof window !== 'undefined') {\n            // Get organization context for better error handling\n            const clerkOrgId = localStorage.getItem('currentOrganizationId');\n            const dbOrgId = localStorage.getItem('dbOrganizationId');\n            \n            // Handle specific error conditions\n            if (error.response?.status === 401) {\n                // Unauthorized - token is invalid or missing\n                console.error('Authentication error: Your session may have expired');\n                window.dispatchEvent(new CustomEvent('auth:unauthorized'));\n            } else if (error.response?.status === 400) {\n                // Organization access issue\n                console.error('Request error:', error.response.data.message);\n                \n                // Log detailed request info for debugging\n                console.error('Request URL:', error.config?.url);\n                console.error('Request headers:', JSON.stringify({\n                    'Authorization': error.config?.headers?.Authorization ? 'Bearer [REDACTED]' : 'None',\n                    'X-Organization-Id': error.config?.headers?.['X-Organization-Id'] || 'None',\n                    'X-DB-Organization-Id': error.config?.headers?.['X-DB-Organization-Id'] || 'None'\n                }));\n                console.log('Request details:', {\n                    method: error.config?.method,\n                    params: error.config?.params,\n                    data: error.config?.data\n                });\n                \n                console.log('Organization IDs:', {\n                    clerkId: clerkOrgId,\n                    dbId: dbOrgId\n                });\n                \n                // If error is organization related, check auth state\n                if (error.response?.data?.message?.includes('organization')) {\n                    window.dispatchEvent(new CustomEvent('org:accessdenied', {\n                        detail: { message: error.response.data.message }\n                    }));\n                }\n            }\n        }\n        \n        return Promise.reject(error);\n    }\n);\n\nexport default api;"],"names":[],"mappings":";;;AAAA;;;;;;AAEA,MAAM,MAAM,0GAAA,CAAA,UAAK,CAAC,MAAM,CAAC;IACrB,SAAS,QAAQ,GAAG,CAAC,WAAW,IAAI;IACpC,SAAS;QACL,gBAAgB;IACpB;IACA,iBAAiB;AACrB;AAEA,mEAAmE;AACnE,IAAI,YAAY,CAAC,OAAO,CAAC,GAAG,CACxB,OAAO;IACH,wCAAmC;QAC/B,4DAA4D;QAC5D,QAAQ,GAAG,CAAC;QACZ,OAAO;IACX;;IAEA,+BAA+B;IAC/B,MAAM;IACN,MAAM;IACN,MAAM;AA6CV,GACA,CAAC;IACG,OAAO,QAAQ,MAAM,CAAC;AAC1B;AAGJ,8CAA8C;AAC9C,IAAI,YAAY,CAAC,QAAQ,CAAC,GAAG,CACzB,CAAC;IACG,QAAQ,GAAG,CAAC,CAAC,kBAAkB,EAAE,SAAS,MAAM,CAAC,GAAG,CAAC,SAAS,EAAE,SAAS,MAAM,EAAE;IAEjF,iDAAiD;IACjD,uCAAmC;;IAenC;IAEA,OAAO;AACX,GACA,CAAC;IACG,QAAQ,KAAK,CAAC,cAAc,OAAO,UAAU,QAAQ,MAAM,OAAO;IAElE,uEAAuE;IACvE,uCAAmC;;IAuCnC;IAEA,OAAO,QAAQ,MAAM,CAAC;AAC1B;uCAGW"}},
    {"offset": {"line": 548, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 555, "column": 0}, "map": {"version":3,"sources":["file:///Users/calebbuffleben/Desktop/projetos/stream/frontend/src/hooks/useApi.ts"],"sourcesContent":["'use client';\n\nimport { useState, useCallback } from 'react';\nimport { useClerk } from '@clerk/nextjs';\nimport api from '../api-connection/service'; // Import the corrected service\n\nexport function useApi() {\n    const { session } = useClerk();\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<Error | null>(null);\n    \n    // Function to get the token and store it if necessary\n    const ensureAuthToken = useCallback(async () => {\n        if (!session) return null; // Return null if no session\n        try {\n            const token = await session.getToken();\n            if (token && typeof window !== 'undefined') {\n                localStorage.setItem('clerkToken', token);\n            }\n            return token;\n        } catch (error) {\n            console.error('Failed to get or set token', error);\n            // Handle token retrieval error, maybe trigger unauthorized event\n            if (typeof window !== 'undefined') {\n                window.dispatchEvent(new CustomEvent('auth:unauthorized'));\n            }\n            return null;\n        }\n    }, [session]);\n    \n    // Specific methods without the internal request function\n    const get = useCallback(async <T,>(url: string): Promise<T | null> => {\n        setLoading(true);\n        setError(null);\n        try {\n            await ensureAuthToken(); // Ensure token is fresh and stored before request\n            const response = await api.get<T>(url);\n            return response.data;\n        } catch (err) {\n            const errorMessage = err instanceof Error ? err.message : 'An unknown error occurred';\n            setError(new Error(errorMessage));\n            console.error(`API Error (GET ${url}):`, err);\n            return null;\n        } finally {\n            setLoading(false);\n        }\n    }, [ensureAuthToken]);\n\n    const post = useCallback(async <T,>(url: string, data?: any): Promise<T | null> => {\n        setLoading(true);\n        setError(null);\n        try {\n            await ensureAuthToken();\n            const response = await api.post<T>(url, data);\n            return response.data;\n        } catch (err) {\n            const errorMessage = err instanceof Error ? err.message : 'An unknown error occurred';\n            setError(new Error(errorMessage));\n            console.error(`API Error (POST ${url}):`, err);\n            return null;\n        } finally {\n            setLoading(false);\n        }\n    }, [ensureAuthToken]);\n\n    const put = useCallback(async <T,>(url: string, data?: any): Promise<T | null> => {\n        setLoading(true);\n        setError(null);\n        try {\n            await ensureAuthToken();\n            const response = await api.put<T>(url, data);\n            return response.data;\n        } catch (err) {\n            const errorMessage = err instanceof Error ? err.message : 'An unknown error occurred';\n            setError(new Error(errorMessage));\n            console.error(`API Error (PUT ${url}):`, err);\n            return null;\n        } finally {\n            setLoading(false);\n        }\n    }, [ensureAuthToken]);\n\n    const del = useCallback(async <T,>(url: string): Promise<T | null> => {\n        setLoading(true);\n        setError(null);\n        try {\n            await ensureAuthToken();\n            const response = await api.delete<T>(url);\n            return response.data;\n        } catch (err) {\n            const errorMessage = err instanceof Error ? err.message : 'An unknown error occurred';\n            setError(new Error(errorMessage));\n            console.error(`API Error (DELETE ${url}):`, err);\n            return null;\n        } finally {\n            setLoading(false);\n        }\n    }, [ensureAuthToken]);\n    \n    return {\n        get,\n        post,\n        put,\n        delete: del,\n        loading,\n        error\n    };\n}\n\nexport default useApi; "],"names":[],"mappings":"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"}},
    {"offset": {"line": 677, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 684, "column": 0}, "map": {"version":3,"sources":["file:///Users/calebbuffleben/Desktop/projetos/stream/frontend/src/components/ApiTestComponent.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport useApi from '../hooks/useApi';\n\ninterface TestResponse {\n  message: string;\n}\n\nexport default function ApiTestComponent() {\n  const { get, loading, error } = useApi();\n  const [response, setResponse] = useState<string | null>(null);\n\n  const testApiConnection = async () => {\n    try {\n      const data = await get<TestResponse>('/');\n      if (data) {\n        setResponse(data.message);\n      } else {\n        setResponse('No data received');\n      }\n    } catch (err) {\n      setResponse(`Error: ${err instanceof Error ? err.message : 'Unknown error'}`);\n    }\n  };\n\n  return (\n    <div className=\"p-4 border rounded-lg shadow-md\">\n      <h2 className=\"text-xl font-bold mb-4\">API Connection Test</h2>\n      \n      <button \n        onClick={testApiConnection}\n        className=\"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition\"\n        disabled={loading}\n      >\n        {loading ? 'Loading...' : 'Test Backend Connection'}\n      </button>\n      \n      {response && (\n        <div className=\"mt-4 p-3 bg-gray-100 rounded\">\n          <p><strong>Response:</strong> {response}</p>\n        </div>\n      )}\n      \n      {error && (\n        <div className=\"mt-4 p-3 bg-red-100 text-red-700 rounded\">\n          <p><strong>Error:</strong> {error.message}</p>\n        </div>\n      )}\n    </div>\n  );\n} "],"names":[],"mappings":";;;;AAEA;AACA;;;;;AAHA;;;;AASe,SAAS;IACtB,MAAM,EAAE,GAAG,EAAE,OAAO,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,+GAAA,CAAA,UAAM,AAAD;IACrC,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,mGAAA,CAAA,WAAQ,AAAD,EAAiB;IAExD,MAAM,oBAAoB;QACxB,IAAI;YACF,MAAM,OAAO,MAAM,IAAkB;YACrC,IAAI,MAAM;gBACR,YAAY,KAAK,OAAO;YAC1B,OAAO;gBACL,YAAY;YACd;QACF,EAAE,OAAO,KAAK;YACZ,YAAY,CAAC,OAAO,EAAE,eAAe,QAAQ,IAAI,OAAO,GAAG,iBAAiB;QAC9E;IACF;IAEA,qBACE,qKAAC;QAAI,WAAU;;0BACb,qKAAC;gBAAG,WAAU;0BAAyB;;;;;;0BAEvC,qKAAC;gBACC,SAAS;gBACT,WAAU;gBACV,UAAU;0BAET,UAAU,eAAe;;;;;;YAG3B,0BACC,qKAAC;gBAAI,WAAU;0BACb,cAAA,qKAAC;;sCAAE,qKAAC;sCAAO;;;;;;wBAAkB;wBAAE;;;;;;;;;;;;YAIlC,uBACC,qKAAC;gBAAI,WAAU;0BACb,cAAA,qKAAC;;sCAAE,qKAAC;sCAAO;;;;;;wBAAe;wBAAE,MAAM,OAAO;;;;;;;;;;;;;;;;;;AAKnD"}},
    {"offset": {"line": 789, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 796, "column": 0}, "map": {"version":3,"sources":["file:///Users/calebbuffleben/Desktop/projetos/stream/frontend/src/pages/index.tsx"],"sourcesContent":["import Image from \"next/image\";\nimport { Geist, Geist_Mono } from \"next/font/google\";\nimport ApiTestComponent from \"../components/ApiTestComponent\";\n\nconst geistSans = Geist({\n  variable: \"--font-geist-sans\",\n  subsets: [\"latin\"],\n});\n\nconst geistMono = Geist_Mono({\n  variable: \"--font-geist-mono\",\n  subsets: [\"latin\"],\n});\n\nexport default function Home() {\n  return (\n    <div\n      className={`${geistSans.variable} ${geistMono.variable} grid grid-rows-[20px_1fr_20px] items-center justify-items-center min-h-screen p-8 pb-20 gap-16 sm:p-20 font-[family-name:var(--font-geist-sans)]`}\n    >\n      <main className=\"flex flex-col gap-8 row-start-2 items-center sm:items-start\">\n        <Image\n          className=\"dark:invert\"\n          src=\"/next.svg\"\n          alt=\"Next.js logo\"\n          width={180}\n          height={38}\n          priority\n        />\n        \n        {/* API Test Component */}\n        <div className=\"w-full max-w-md mb-8\">\n          <ApiTestComponent />\n        </div>\n        \n        <ol className=\"list-inside list-decimal text-sm text-center sm:text-left font-[family-name:var(--font-geist-mono)]\">\n          <li className=\"mb-2\">\n            Get started by editing{\" \"}\n            <code className=\"bg-black/[.05] dark:bg-white/[.06] px-1 py-0.5 rounded font-semibold\">\n              src/pages/index.tsx\n            </code>\n            .\n          </li>\n          <li>Save and see your changes instantly.</li>\n        </ol>\n\n        <div className=\"flex gap-4 items-center flex-col sm:flex-row\">\n          <a\n            className=\"rounded-full border border-solid border-transparent transition-colors flex items-center justify-center bg-foreground text-background gap-2 hover:bg-[#383838] dark:hover:bg-[#ccc] text-sm sm:text-base h-10 sm:h-12 px-4 sm:px-5\"\n            href=\"https://vercel.com/new?utm_source=create-next-app&utm_medium=default-template-tw&utm_campaign=create-next-app\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            <Image\n              className=\"dark:invert\"\n              src=\"/vercel.svg\"\n              alt=\"Vercel logomark\"\n              width={20}\n              height={20}\n            />\n            Deploy now\n          </a>\n          <a\n            className=\"rounded-full border border-solid border-black/[.08] dark:border-white/[.145] transition-colors flex items-center justify-center hover:bg-[#f2f2f2] dark:hover:bg-[#1a1a1a] hover:border-transparent text-sm sm:text-base h-10 sm:h-12 px-4 sm:px-5 sm:min-w-44\"\n            href=\"https://nextjs.org/docs?utm_source=create-next-app&utm_medium=default-template-tw&utm_campaign=create-next-app\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            Read our docs\n          </a>\n        </div>\n      </main>\n      <footer className=\"row-start-3 flex gap-6 flex-wrap items-center justify-center\">\n        <a\n          className=\"flex items-center gap-2 hover:underline hover:underline-offset-4\"\n          href=\"https://nextjs.org/learn?utm_source=create-next-app&utm_medium=default-template-tw&utm_campaign=create-next-app\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          <Image\n            aria-hidden\n            src=\"/file.svg\"\n            alt=\"File icon\"\n            width={16}\n            height={16}\n          />\n          Learn\n        </a>\n        <a\n          className=\"flex items-center gap-2 hover:underline hover:underline-offset-4\"\n          href=\"https://vercel.com/templates?framework=next.js&utm_source=create-next-app&utm_medium=default-template-tw&utm_campaign=create-next-app\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          <Image\n            aria-hidden\n            src=\"/window.svg\"\n            alt=\"Window icon\"\n            width={16}\n            height={16}\n          />\n          Examples\n        </a>\n        <a\n          className=\"flex items-center gap-2 hover:underline hover:underline-offset-4\"\n          href=\"https://nextjs.org?utm_source=create-next-app&utm_medium=default-template-tw&utm_campaign=create-next-app\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          <Image\n            aria-hidden\n            src=\"/globe.svg\"\n            alt=\"Globe icon\"\n            width={16}\n            height={16}\n          />\n          Go to nextjs.org →\n        </a>\n      </footer>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAAA;;;AAEA;;;;;;;;;;AAYe,SAAS;IACtB,qBACE,qKAAC;QACC,WAAW,GAAG,kIAAA,CAAA,UAAS,CAAC,QAAQ,CAAC,CAAC,EAAE,uIAAA,CAAA,UAAS,CAAC,QAAQ,CAAC,iJAAiJ,CAAC;;0BAEzM,qKAAC;gBAAK,WAAU;;kCACd,qKAAC,sHAAA,CAAA,UAAK;wBACJ,WAAU;wBACV,KAAI;wBACJ,KAAI;wBACJ,OAAO;wBACP,QAAQ;wBACR,QAAQ;;;;;;kCAIV,qKAAC;wBAAI,WAAU;kCACb,cAAA,qKAAC,+HAAA,CAAA,UAAgB;;;;;;;;;;kCAGnB,qKAAC;wBAAG,WAAU;;0CACZ,qKAAC;gCAAG,WAAU;;oCAAO;oCACI;kDACvB,qKAAC;wCAAK,WAAU;kDAAuE;;;;;;oCAEhF;;;;;;;0CAGT,qKAAC;0CAAG;;;;;;;;;;;;kCAGN,qKAAC;wBAAI,WAAU;;0CACb,qKAAC;gCACC,WAAU;gCACV,MAAK;gCACL,QAAO;gCACP,KAAI;;kDAEJ,qKAAC,sHAAA,CAAA,UAAK;wCACJ,WAAU;wCACV,KAAI;wCACJ,KAAI;wCACJ,OAAO;wCACP,QAAQ;;;;;;oCACR;;;;;;;0CAGJ,qKAAC;gCACC,WAAU;gCACV,MAAK;gCACL,QAAO;gCACP,KAAI;0CACL;;;;;;;;;;;;;;;;;;0BAKL,qKAAC;gBAAO,WAAU;;kCAChB,qKAAC;wBACC,WAAU;wBACV,MAAK;wBACL,QAAO;wBACP,KAAI;;0CAEJ,qKAAC,sHAAA,CAAA,UAAK;gCACJ,aAAW;gCACX,KAAI;gCACJ,KAAI;gCACJ,OAAO;gCACP,QAAQ;;;;;;4BACR;;;;;;;kCAGJ,qKAAC;wBACC,WAAU;wBACV,MAAK;wBACL,QAAO;wBACP,KAAI;;0CAEJ,qKAAC,sHAAA,CAAA,UAAK;gCACJ,aAAW;gCACX,KAAI;gCACJ,KAAI;gCACJ,OAAO;gCACP,QAAQ;;;;;;4BACR;;;;;;;kCAGJ,qKAAC;wBACC,WAAU;wBACV,MAAK;wBACL,QAAO;wBACP,KAAI;;0CAEJ,qKAAC,sHAAA,CAAA,UAAK;gCACJ,aAAW;gCACX,KAAI;gCACJ,KAAI;gCACJ,OAAO;gCACP,QAAQ;;;;;;4BACR;;;;;;;;;;;;;;;;;;;AAMZ"}},
    {"offset": {"line": 1018, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}